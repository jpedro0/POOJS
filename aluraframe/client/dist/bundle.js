!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Negociacao=function(){function e(t,n,o){r(this,e),this._data=new Date(t.getTime()),this._quantidade=n,this._valor=o,Object.freeze(this)}return o(e,[{key:"volume",get:function(){return this._quantidade*this._valor}},{key:"data",get:function(){return new Date(this._data.getTime())}},{key:"quantidade",get:function(){return this._quantidade}},{key:"valor",get:function(){return this._valor}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){return y}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.currentInstance=o;var i=n(5),c=n(0),u=n(6),s=n(7),f=n(8),l=n(9),h=n(3),d=n(13),p=function(){function e(){r(this,e);var t=document.querySelector.bind(document);this._inputQuantidade=t("#quantidade"),this._inputData=t("#data"),this._inputValor=t("#valor"),this._ordemAtual="",this._service=new l.NegociacaoService,this._listaNegociacoes=new d.Bind(new u.ListaNegociacoes,new s.NegociacoesView(t("#negociacoesView")),"adiciona","esvazia","ordena","inverteOrdem"),this._mensagem=new d.Bind(new i.Mensagem,new f.MensagemView(t("#mensagemView")),"texto"),this._init()}return a(e,[{key:"_init",value:function(){var e=this;this._service.lista().then(function(t){return t.forEach(function(t){return e._listaNegociacoes.adiciona(t)})}).catch(function(t){return e._mensagem.texto=t}),setInterval(function(){e.importaNegociacoes()},3e3)}},{key:"adiciona",value:function(e){var t=this;e.preventDefault();var n=this._criarNegociacao();this._service.cadastra(n).then(function(e){t._listaNegociacoes.adiciona(n),t._mensagem.texto=e,t._limpaFormulario()}).catch(function(e){return t._mensagem.texto=e})}},{key:"importaNegociacoes",value:function(){var e=this;this._service.importa(this._listaNegociacoes.negociacoes).then(function(t){return t.forEach(function(t){e._listaNegociacoes.adiciona(t),e._mensagem.texto="Negociações importadas com sucesso."})}).catch(function(t){return e._mensagem.texto=t})}},{key:"ordena",value:function(e){this._ordemAtual==e?this._listaNegociacoes.inverteOrdem():this._listaNegociacoes.ordena(function(t,n){return t[e]-n[e]}),this._ordemAtual=e}},{key:"apaga",value:function(){var e=this;this._service.apaga().then(function(t){e._mensagem.texto=t,e._listaNegociacoes.esvazia()}).catch(function(t){return e._mensagem.texto=t})}},{key:"_criarNegociacao",value:function(){return new c.Negociacao(h.DateHelper.textoParaData(this._inputData.value),parseInt(this._inputQuantidade.value),parseFloat(this._inputValor.value))}},{key:"_limpaFormulario",value:function(){this._inputData.value="",this._inputQuantidade.value=1,this._inputValor.value=0,this._inputData.focus()}}]),e}(),y=new p},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.View=function(){function e(t){r(this,e),this._elemento=t}return o(e,[{key:"update",value:function(e){this._elemento.innerHTML=this.template(e)}},{key:"template",value:function(){throw new Error("O método template deve ser implementado")}}]),e}()},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.DateHelper=function(){function e(){throw o(this,e),new Error("Esta classe não pode sert instanciada")}return a(e,null,[{key:"textoParaData",value:function(e){if(!/\d{4}-\d{2}-\d{2}/.test(e))throw new Error("Deve estar no formato aaaa-mm-dd");return new(Function.prototype.bind.apply(Date,[null].concat(r(e.split("-").map(function(e,t){return e-t%2})))))}},{key:"dataParaTexto",value:function(e){return e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}}]),e}()},function(e,t,n){"use strict";var r=n(1);n(15);var o=(0,r.currentInstance)();document.querySelector(".form").onsubmit=o.adiciona.bind(o),document.querySelector("button[type=button]").onclick=o.apaga.bind(o)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Mensagem=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";r(this,e),this._texto=t}return o(e,[{key:"texto",get:function(){return this._texto},set:function(e){this._texto=e}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.ListaNegociacoes=function(){function e(){r(this,e),this._negociacoes=[]}return o(e,[{key:"adiciona",value:function(e){this._negociacoes.push(e)}},{key:"esvazia",value:function(){this._negociacoes=[]}},{key:"ordena",value:function(e){this._negociacoes.sort(e)}},{key:"inverteOrdem",value:function(){this._negociacoes.reverse()}},{key:"negociacoes",get:function(){return[].concat(this._negociacoes)}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NegociacoesView=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),u=n(3),s=n(1);t.NegociacoesView=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e.addEventListener("click",function(e){"TH"==e.target.nodeName&&(0,s.currentInstance)().ordena(e.target.textContent.toLowerCase())}),n}return a(t,e),i(t,[{key:"template",value:function(e){return'\n            <table class="table table-hover table-bordered">\n                <thead>\n                    <tr>\n                        <th>DATA</th>\n                        <th>QUANTIDADE</th>\n                        <th>VALOR</th>\n                        <th>VOLUME</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    '+e.negociacoes.map(function(e){return"<tr>\n                           <td>"+u.DateHelper.dataParaTexto(e.data)+"</td>\n                           <td>"+e.quantidade+"</td>\n                           <td>"+e.valor+"</td>\n                           <td>"+e.volume+"</td>\n                        </tr>"}).join("")+'\n                </tbody>\n                <tfoot>\n                        <td colspan="3"></td>\n                        <td>\n                            '+e.negociacoes.reduce(function(e,t){return e+t.volume},0)+"\n                        </td>\n                </tfoot>\n            </table>\n        "}}]),t}(c.View)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MensagemView=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2);t.MensagemView=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),i(t,[{key:"template",value:function(e){return e.texto?'\n            <p class="alert alert-info">'+e.texto+"</p>":"<p></p>"}}]),t}(c.View)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.NegociacaoService=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(10),i=n(0),c=n(11),u=n(12);t.NegociacaoService=function(){function e(){r(this,e),this._http=new a.HttpService}return o(e,[{key:"obterNegociacoes",value:function(){return Promise.all([this.obterNegociacaoDaSemana(),this.obterNegociacaoDaSemanaAnterior(),this.obterNegociacaoDaSemanaRetrasada()]).then(function(e){return e.reduce(function(e,t){return e.concat(t)},[])}).catch(function(e){throw new Error(e)})}},{key:"obterNegociacaoDaSemana",value:function(){var e=this;return new Promise(function(t,n){e._http.get("negociacoes/semana").then(function(e){return t(e.map(function(e){return new i.Negociacao(new Date(e.data),e.quantidade,e.valor)}))}).catch(function(e){console.log(e),n("Não foi possivel obter as negociações")})})}},{key:"obterNegociacaoDaSemanaAnterior",value:function(){var e=this;return new Promise(function(t,n){e._http.get("negociacoes/anterior").then(function(e){return t(e.map(function(e){return new i.Negociacao(new Date(e.data),e.quantidade,e.valor)}))}).catch(function(e){console.log(e),n("Não foi possivel obter as negociações anteriores")})})}},{key:"obterNegociacaoDaSemanaRetrasada",value:function(){var e=this;return new Promise(function(t,n){e._http.get("negociacoes/retrasada").then(function(e){return t(e.map(function(e){return new i.Negociacao(new Date(e.data),e.quantidade,e.valor)}))}).catch(function(e){console.log(e),n("Não foi possivel obter as negociações retrasadas")})})}},{key:"cadastra",value:function(e){return c.ConnectionFactory.getConnection().then(function(e){return new u.NegociacaoDao(e)}).then(function(t){return t.adiciona(e)}).then(function(){return"Negociação adicionada com sucesso"}).catch(function(e){throw console.log(e),new Error("Não foi possivel adicionar a negociação")})}},{key:"lista",value:function(){return c.ConnectionFactory.getConnection().then(function(e){return new u.NegociacaoDao(e)}).then(function(e){return e.listaTodos()}).catch(function(e){throw console.log(e),new Error("Não foi possivel carregar a lista de negociações")})}},{key:"apaga",value:function(){return c.ConnectionFactory.getConnection().then(function(e){return new u.NegociacaoDao(e)}).then(function(e){return e.apagarTodos()}).then(function(){return"Lista de Negociações apagadas com sucesso"}).catch(function(e){throw console.log(e),new Error("Não foi possivel apagar a lista de negociações")})}},{key:"importa",value:function(e){return this.obterNegociacoes().then(function(t){return t.filter(function(t){return!e.some(function(e){return JSON.stringify(t)==JSON.stringify(e)})})}).catch(function(e){throw console.log(e),new Error("Não foi possivel buscar a lista de negociações importadas")})}},{key:"isEquals",value:function(e){return JSON.stringify(this)==JSON.stringify(e)}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.HttpService=function(){function e(){r(this,e)}return o(e,[{key:"_handleErrors",value:function(e){if(!e.ok)throw new Error(e.statusText);return e}},{key:"get",value:function(e){var t=this;return fetch(e).then(function(e){return t._handleErrors(e)}).then(function(e){return e.json()})}},{key:"post",value:function(e,t){var n=this;return fetch(e,{headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify(t)}).then(function(e){return n._handleErrors(e)})}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=["negociacoes"],i=null,c=null;t.ConnectionFactory=function(){function e(){throw r(this,e),new Error("Não é possivel criar instancias de connnerctionFactory")}return o(e,null,[{key:"getConnection",value:function(){return new Promise(function(t,n){var r=window.indexedDB.open("aluraframe",1);r.onupgradeneeded=function(t){e._createStores(t.target.result)},r.onsuccess=function(e){i||(i=e.target.result,c=i.close.bind(i),i.close=function(){throw new Error("Você não fechar diretamnete a conexão")}),t(i)},r.onerror=function(e){console.log(e.target.error),n(e.target.error.name)}})}},{key:"_createStores",value:function(e){a.forEach(function(t){e.objectStoreNames.contains(t)&&e.deleteObjectStore(t),e.createObjectStore(t,{autoIncrement:!0})})}},{key:"closeConnection",value:function(){i&&(c(),i=[])}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.NegociacaoDao=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0);t.NegociacaoDao=function(){function e(t){r(this,e),this._connection=t,this._store="negociacoes"}return o(e,[{key:"adiciona",value:function(e){var t=this;return new Promise(function(n,r){var o=t._connection.transaction([t._store],"readwrite").objectStore(t._store).add(e);o.onsuccess=function(e){n()},o.onerror=function(e){console.log(e.target.error),r("Não foi possivel adicionar a negociação")}})}},{key:"listaTodos",value:function(){var e=this;return new Promise(function(t,n){var r=e._connection.transaction([e._store],"readwrite").objectStore(e._store).openCursor(),o=[];r.onsuccess=function(e){var n=e.target.result;if(n){var r=n.value;o.push(new a.Negociacao(r._data,r._quantidade,r._valor)),n.continue()}else t(o)},r.onerror=function(e){console.log(e.target.error),n("Não foi possivel lista as negociações")}})}},{key:"apagarTodos",value:function(){var e=this;return new Promise(function(t,n){var r=e._connection.transaction([e._store],"readwrite").objectStore(e._store).clear();r.onsuccess=function(e){return t("Negociações apagadas com sucesso")},r.onerror=function(e){console.log(e.target.error),n("Não foi possivel remover as negociações")}})}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Bind=void 0;var o=n(14);t.Bind=function e(t,n){r(this,e);for(var a=arguments.length,i=Array(a>2?a-2:0),c=2;c<a;c++)i[c-2]=arguments[c];var u=o.ProxyFactory.create(t,i,function(e){return n.update(e)});return n.update(t),u}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.ProxyFactory=function(){function e(){r(this,e)}return a(e,null,[{key:"create",value:function(t,n,r){return new Proxy(t,{get:function(t,o,a){return n.includes(o)&&e._ehFuncao(t[o])?function(){return console.log('a propriedade "'+o+'" foi interceptada'),Reflect.apply(t[o],t,arguments),r(t)}:Reflect.get(t,o,a)},set:function(e,t,o,a){return n.includes(t)&&(e[t]=o,r(e)),Reflect.set(e,t,o,a)}})}},{key:"_ehFuncao",value:function(e){return(void 0===e?"undefined":o(e))==("undefined"==typeof Function?"undefined":o(Function))}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&DataView.prototype.isPrototypeOf(e)}function o(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e)||""===e)throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){return"string"!=typeof e&&(e=String(e)),e}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return _.iterable&&(t[Symbol.iterator]=function(){return t}),t}function c(e){this.map={},e instanceof c?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function u(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function s(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=s(t);return t.readAsArrayBuffer(e),n}function l(e){var t=new FileReader,n=s(t);return t.readAsText(e),n}function h(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:_.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:_.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:_.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():_.arrayBuffer&&_.blob&&r(e)?(this._bodyArrayBuffer=d(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):_.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||P(e))?this._bodyArrayBuffer=d(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):_.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},_.blob&&(this.blob=function(){var e=u(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e=u(this);if(e)return e;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(h(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},_.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e){var t=e.toUpperCase();return E.indexOf(t)>-1?t:e}function b(e,t){t=t||{};var n=t.body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new c(t.headers)),this.method=y(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function v(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function g(e){var t=new c;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t}function m(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new c(t.headers),this.url=t.url||"",this._initBody(e)}function w(e,t){return new Promise(function(n,r){function o(){i.abort()}var a=new b(e,t);if(a.signal&&a.signal.aborted)return r(new N("Aborted","AbortError"));var i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:g(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;n(new m(t,e))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.onabort=function(){r(new N("Aborted","AbortError"))},i.open(a.method,a.url,!0),"include"===a.credentials?i.withCredentials=!0:"omit"===a.credentials&&(i.withCredentials=!1),"responseType"in i&&_.blob&&(i.responseType="blob"),a.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),a.signal&&(a.signal.addEventListener("abort",o),i.onreadystatechange=function(){4===i.readyState&&a.signal.removeEventListener("abort",o)}),i.send(void 0===a._bodyInit?null:a._bodyInit)})}Object.defineProperty(t,"__esModule",{value:!0}),t.Headers=c,t.Request=b,t.Response=m,t.fetch=w;var _={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(_.arrayBuffer)var O=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],P=ArrayBuffer.isView||function(e){return e&&O.indexOf(Object.prototype.toString.call(e))>-1};c.prototype.append=function(e,t){e=o(e),t=a(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},c.prototype.delete=function(e){delete this.map[o(e)]},c.prototype.get=function(e){return e=o(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(o(e))},c.prototype.set=function(e,t){this.map[o(e)]=a(t)},c.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},c.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),i(e)},c.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},c.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),i(e)},_.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},p.call(b.prototype),p.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},m.error=function(){var e=new m(null,{status:0,statusText:""});return e.type="error",e};var j=[301,302,303,307,308];m.redirect=function(e,t){if(-1===j.indexOf(t))throw new RangeError("Invalid status code");return new m(null,{status:t,headers:{location:e}})};var N=t.DOMException=self.DOMException;try{new N}catch(e){t.DOMException=N=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},N.prototype=Object.create(Error.prototype),N.prototype.constructor=N}w.polyfill=!0,self.fetch||(self.fetch=w,self.Headers=c,self.Request=b,self.Response=m)}]);